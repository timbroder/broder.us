(function(a){a.address=function(){var b=function(b){a(a.address).trigger(a.extend(a.Event(b),function(){for(var b={},c=a.address.parameterNames(),d=0,e=c.length;d<e;d++)b[c[d]]=a.address.parameter(c[d]);return{value:a.address.value(),path:a.address.path(),pathNames:a.address.pathNames(),parameterNames:c,parameters:b,queryString:a.address.queryString()}}.call(a.address)))},c=function(b,c,d){a(a.address).bind(b,c,d);return a.address},d=function(){var a=L.href.indexOf("#");return a!=-1?P(O(h(L.href.substr(a+1),z))):""},e=function(){return"javascript"},f=function(a,b){A.strict&&(a=b?a.substr(0,1)!="/"?"/"+a:a:a==""?"/":a);return a},g=function(a,b){return E&&L.protocol=="file:"?b?bb.replace(/\?/,"%3F"):bb.replace(/%253F/,"?"):a},h=function(a,b){if(A.crawlable&&b)return(a!=""?"!":"")+a;return a.replace(/^\!/,"")},i=function(a,b){return parseInt(a.css(b),10)},j=function(a){for(var b,c,d=0,e=a.childNodes.length;d<e;d++){a.childNodes[d].src&&(b=String(a.childNodes[d].src));if(c=j(a.childNodes[d]))b=c}return b},k=function(){if(!X){var a=d(),b=bb!=a;G&&C<523?W!=K.length&&(W=K.length,typeof ba[W-1]!=t&&(bb=ba[W-1]),l(z)):E&&C<7&&b?L.reload():b&&(bb=a,l(z))}},l=function(a){b(v),b(a?w:x),N(m,10)},m=function(){var b=(L.pathname+(/\/$/.test(L.pathname)?"":"/")+(a.address?a.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,""),c=I[A.tracker];typeof c==s?c(b):typeof urchinTracker==s?urchinTracker(b):typeof pageTracker!=t&&typeof pageTracker._trackPageview==s?pageTracker._trackPageview(b):typeof _gaq!=t&&typeof _gaq.push==s&&_gaq.push(["_trackPageview",b])},n=function(){var a=R.contentWindow.document;a.open(),a.write("<html><head><title>"+J.title+"</title><script>var "+r+' = "'+d()+'";</script></head></html>'),a.close()},o=function(){if(!Y){Y=y;var c=a("body").ajaxComplete(function(){q.call(this)}).trigger("ajaxComplete");A.wrap&&(a("body > *").wrapAll('<div style="padding:'+(i(c,"marginTop")+i(c,"paddingTop"))+"px "+(i(c,"marginRight")+i(c,"paddingRight"))+"px "+(i(c,"marginBottom")+i(c,"paddingBottom"))+"px "+(i(c,"marginLeft")+i(c,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+r+'" style="height:100%; overflow:auto;'+(G?window.statusbar.visible&&!/chrome/i.test(Q)?"":" resize:both;":"")+'" />'),a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),G&&a('<style type="text/css" />').appendTo("head").text("#"+r+"::-webkit-resizer { background-color: #fff; }")),E&&C<8?(c=J.getElementsByTagName("frameset")[0],R=J.createElement((c?"":"i")+"frame"),c?(c.insertAdjacentElement("beforeEnd",R),c[c.cols?"cols":"rows"]+=",0",R.src=e()+":"+z,R.noResize=y,R.frameBorder=R.frameSpacing=0):(R.src=e()+":"+z,R.style.display="none",J.body.insertAdjacentElement("afterBegin",R)),N(function(){a(R).bind("load",function(){var a=R.contentWindow;bb=typeof a[r]!=t?a[r]:"",bb!=d()&&(l(z),L.hash=g(h(bb,y),y))}),typeof R.contentWindow[r]==t&&n()},50)):G&&(C<418&&(a(J.body).append('<form id="'+r+'" style="position:absolute;top:-9999px;" method="get"></form>'),S=J.getElementById(r)),typeof L[r]==t&&(L[r]={}),typeof L[r][L.pathname]!=t&&(ba=L[r][L.pathname].split(","))),N(function(){b("init"),l(z)},1),E&&C>7||!E&&"on"+u in I?I.addEventListener?I.addEventListener(u,k,!1):I.attachEvent&&I.attachEvent("on"+u,k):M(k,50),a("a").filter("[rel*=address:]").address()}},p=function(){I.removeEventListener?I.removeEventListener(u,k,!1):I.detachEvent&&I.detachEvent("on"+u,k)},q=function(){var b=L.pathname.replace(/\/$/,"");a("body").html().indexOf("_escaped_fragment_")!=-1&&a("a[href]:not([href^=http])",this).each(function(){var c=a(this).attr("href").replace(new RegExp(b+"/?$"),"");(c==""||c.indexOf("_escaped_fragment_")!=-1)&&a(this).attr("href","#"+decodeURIComponent(c.replace(/\/(.*)\?_escaped_fragment_=(.*)$/,"!$2")))})},r="jQueryAddress",s="function",t="undefined",u="hashchange",v="change",w="internalChange",x="externalChange",y=!0,z=!1,A={autoUpdate:y,crawlable:z,history:y,strict:y,wrap:z},B=a.browser,C=parseFloat(a.browser.version),D=B.mozilla,E=B.msie,F=B.opera,G=B.safari,H=z,I=function(){try{return top.document!==undefined?top:window}catch(a){return window}}(),J=I.document,K=I.history,L=I.location,M=setInterval,N=setTimeout,O=decodeURI,P=encodeURI,Q=navigator.userAgent,R,S,T=j(document),U=T?T.indexOf("?"):-1,V=J.title,W=K.length,X=z,Y=z,Z=y,$=y,_=z,ba=[],bb=d();E&&(C=parseFloat(Q.substr(Q.indexOf("MSIE")+4)),J.documentMode&&J.documentMode!=C&&(C=J.documentMode!=8?7:8),a(document).bind("propertychange",function(){J.title!=V&&J.title.indexOf("#"+d())!=-1&&(J.title=V)}));if(H=D&&C>=1||E&&C>=6||F&&C>=9.5||G&&C>=312){for(B=1;B<W;B++)ba.push("");ba.push(bb),E&&L.hash!=bb&&(L.hash="#"+g(h(bb,y),y)),F&&(history.navigationMode="compatible");if(T&&U!=-1){T=T.substr(U+1).split("&");for(B=0;B<T.length;B++)F=T[B].split("="),/^(autoUpdate|crawlable|history|strict|wrap)$/.test(F[0])&&(A[F[0]]=isNaN(F[1])?/^(true|yes)$/i.test(F[1]):parseInt(F[1],10)!==0),/^tracker$/.test(F[0])&&(A[F[0]]=F[1])}document.readyState=="complete"&&o(),a(o),a(window).bind("unload",p)}else!H&&d()!=""||G&&C<418&&d()!=""&&L.search!=""?(J.open(),J.write('<html><head><meta http-equiv="refresh" content="0;url='+encodeURI(L.href.substr(0,L.href.indexOf("#")))+'" /></head></html>'),J.close()):m();return{bind:function(a,b,d){return c(a,b,d)},init:function(a){return c("init",a)},change:function(a){return c(v,a)},internalChange:function(a){return c(w,a)},externalChange:function(a){return c(x,a)},baseURL:function(){var a=L.href;a.indexOf("#")!=-1&&(a=a.substr(0,a.indexOf("#"))),/\/$/.test(a)&&(a=a.substr(0,a.length-1));return a},autoUpdate:function(a){if(a!==undefined){A.autoUpdate=a;return this}return A.autoUpdate},crawlable:function(a){if(a!==undefined){A.crawlable=a;return this}return A.crawlable},history:function(a){if(a!==undefined){A.history=a;return this}return A.history},strict:function(a){if(a!==undefined){A.strict=a;return this}return A.strict},tracker:function(a){if(a!==undefined){A.tracker=a;return this}return A.tracker},wrap:function(a){if(a!==undefined){A.wrap=a;return this}return A.wrap},update:function(){_=y,this.value(bb),_=z;return this},title:function(a){if(a!==undefined){a=O(a),N(function(){V=J.title=a,$&&R&&R.contentWindow&&R.contentWindow.document&&(R.contentWindow.document.title=a,$=z),!Z&&D&&L.replace(L.href.indexOf("#")!=-1?L.href:L.href+"#"),Z=z},50);return this}return J.title},value:function(a){if(a!==undefined){a=P(O(f(a,y))),a=="/"&&(a="");if(bb==a&&!_)return;Z=y,bb=a;if(A.autoUpdate||_){X=y,l(y),ba[K.length]=bb;if(G)if(A.history){L[r][L.pathname]=ba.toString(),W=K.length+1;if(C<418)L.search==""&&(S.action="#"+h(bb,y),S.submit());else if(C<523||bb==""){a=J.createEvent("MouseEvents"),a.initEvent("click",y,y);var b=J.createElement("a");b.href="#"+h(bb,y),b.dispatchEvent(a)}else L.hash="#"+h(bb,y)}else L.replace("#"+h(bb,y));else bb!=d()&&(A.history?L.hash="#"+g(h(bb,y),y):L.replace("#"+h(bb,y)));E&&C<8&&A.history&&N(n,50),G?N(function(){X=z},1):X=z}return this}if(!H)return null;return O(f(g(bb,z),z))},path:function(a){if(a!==undefined){var b=this.queryString(),c=this.hash();this.value(a+(b?"?"+b:"")+(c?"#"+c:""));return this}return this.value().split("#")[0].split("?")[0]},queryString:function(a){if(a!==undefined){var b=this.hash();this.value(this.path()+(a?"?"+a:"")+(b?"#"+b:""));return this}a=this.value().split("?");return a.slice(1,a.length).join("?").split("#")[0]},parameter:function(b,c,d){var e,f;if(c!==undefined){var g=this.parameterNames();f=[];for(e=0;e<g.length;e++){var h=g[e],i=this.parameter(h);typeof i=="string"&&(i=[i]),h==b&&(i=c===null||c===""?[]:d?i.concat([c]):[c]);for(var j=0;j<i.length;j++)f.push(h+"="+i[j])}a.inArray(b,g)==-1&&c!==null&&c!==""&&f.push(b+"="+c),this.queryString(f.join("&"));return this}if(c=this.queryString()){f=c.split("&"),c=[];for(e=0;e<f.length;e++)d=f[e].split("="),d[0]==b&&c.push(d[1]);if(c.length!==0)return c.length!=1?c:c[0]}},pathNames:function(){var a=this.path(),b=a.replace(/\/{2,9}/g,"/").split("/");(a.substr(0,1)=="/"||a.length===0)&&b.splice(0,1),a.substr(a.length-1,1)=="/"&&b.splice(b.length-1,1);return b},parameterNames:function(){var b=this.queryString(),c=[];if(b&&b.indexOf("=")!=-1){b=b.split("&");for(var d=0;d<b.length;d++){var e=b[d].split("=")[0];a.inArray(e,c)==-1&&c.push(e)}}return c},hash:function(a){if(a!==undefined){this.value(this.value().split("#")[0]+(a?"#"+a:""));return this}a=this.value().split("#");return a.slice(1,a.length).join("#")}}}(),a.fn.address=function(b){var c=function(){if(a(this).is("a")){var c=b?b.call(this):/address:/.test(a(this).attr("rel"))?a(this).attr("rel").split("address:")[1].split(" ")[0]:a(this).attr("href").replace(/^#\!?/,"");a.address.value(c);return!1}};a(this).click(c).live("click",c),a(this).live("submit",function(){if(a(this).is("form")){var c=b?b.call(this):a(this).attr("action")+"?"+a(this).serialize();a.address.value(c);return!1}});return this}})(jQuery)